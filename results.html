<head>
<link href="https://fonts.googleapis.com/css?family=Montserrat:300,400,700|Roboto:400,700" rel="stylesheet">
<link href='style.css' rel='stylesheet' type='text/css'>
<title>3dimensions Results</title>
<link rel="icon" type="x-icon" href="icon.png">
<link rel="shortcut icon" type="x-icon" href="icon.png">
<meta charset="utf-8">
</head>
<script type="application/javascript"
        src="ideologies.js">
</script>

<body>
<h1>3dimensions</h1>
<hr>

<h1>Results</h1>

<h2>Identity: <span class="weight-300" id="identity-label"></span></h2>
<div class="axis">
    <img id="img-globalism" src="value_images/globalism.png" height="128pt"/>
    <div class="bar globalism" id="bar-globalism"><div class="text-wrapper" id="globalism"></div></div>
    <div class="bar individualism" id="bar-individualism"><div class="text-wrapper" id="individualism"></div></div>
    <img id="img-individualism" src="value_images/individualism.png" height="128pt"/>
</div>

<h2>Property: <span class="weight-300" id="property-label"></span></h2>
<div class="axis">
    <img id="img-collectivism" src="value_images/collectivism.png" height="128pt"/>
    <div class="bar collectivism" id="bar-collectivism"><div class="text-wrapper" id="collectivism"></div></div>
    <div class="bar privatism" id="bar-privatism"><div class="text-wrapper" id="privatism"></div></div>
    <img id="img-privatism" src="value_images/privatism.png" height="128pt"/>
</div>

<h2>Culture: <span class="weight-300" id="culture-label"></span></h2>
<div class="axis">
    <img id="img-diversity" src="value_images/diversity.png" height="128pt"/>
    <div class="bar diversity" id="bar-diversity"><div class="text-wrapper" id="diversity"></div></div>
    <div class="bar cohesion" id="bar-cohesion"><div class="text-wrapper" id="cohesion"></div></div>
    <img id="img-cohesion" src="value_images/cohesion.png" height="128pt"/>
</div>

<h2>Closest Match: <span class="weight-300" id="ideology-label"></span></h2>
<p>Ideological matching is a work in progress, and is much less accurate than the values and axes.</p>
<p>You can send these results by copying and pasting the URL at the top of the page or using the image below. Think your matched ideology was wrong? Want to help us calibrate the test? Send the results along with your political ideology to us at <a href="mailto:eightvalues@gmail.com">eightvalues@gmail.com</a>, or send us any comments, questions, or criticism. You can also visit our GitHub page here: <a href="https://github.com/3dimensions/3dimensions.github.io">GitHub Page</a> </p>
<hr/>
<canvas id="banner" width=800 height=600 style="font-family:Montserrat"></canvas>
<button class="button" onclick="location.href='index.html';" style="background-color: #2196f3;">Back</button> <br>

<!-- JavaScript for the test itself -->
<script>
    function getQueryVariable(variable)
    {
           var query = window.location.search.substring(1)
           var vars = query.split("&")
           for (var i=0;i<vars.length;i++) {
                   var pair = vars[i].split("=")
                   if(pair[0] == variable) {return pair[1]}
           }
           return(NaN);
    }

    function setBarValue(name, value) {
        innerel = document.getElementById(name)
        outerel = document.getElementById("bar-" + name)
        outerel.style.width = (value + "%")
        innerel.innerHTML = (value + "%")
        if (innerel.offsetWidth + 20 > outerel.offsetWidth) {
            innerel.style.visibility = "hidden"
        }
    }

    idtyArray = ["Globalist", "Cosmopolitan", "Civic Nationalist", "Ethno-Nationalist", "Covenant Communitarian"]
    propArray = ["Communist", "Socialist", "Statist", "Minarchist", "Anarchist"]
    cultArray = ["Revolutionary", "Progressive", "Neutral", "Traditional", "Reactionary"]

    function setLabel(val,ary) {
        if (val > 100) { return "" } else
        if (val > 80) { return ary[0] } else
        if (val > 60) { return ary[1] } else
        if (val > 40) { return ary[2] } else
        if (val > 20) { return ary[3] } else
        if (val >= 0) { return ary[4] } else
        	{return ""}
    }

    globalism     = getQueryVariable("i")
    collectivism  = getQueryVariable("p")
    diversity     = getQueryVariable("c")
    individualism = (100 - globalism).toFixed(1)
    privatism     = (100 - collectivism).toFixed(1)
    cohesion      = (100 - diversity).toFixed(1)

    setBarValue("globalism", globalism)
    setBarValue("individualism", individualism)

    setBarValue("collectivism", collectivism)
    setBarValue("privatism", privatism)
    
    setBarValue("diversity", diversity)
    setBarValue("cohesion", cohesion)

    document.getElementById("identity-label").innerHTML = setLabel(globalism, idtyArray)
    document.getElementById("property-label").innerHTML = setLabel(collectivism, propArray)
    document.getElementById("culture-label").innerHTML = setLabel(diversity, cultArray)

    ideology = ""
    ideodist = Infinity
    for (var i = 0; i < ideologies.length; i++) {
        dist = 0
        dist += Math.pow(Math.abs(ideologies[i].stats.idty - globalism), 2)
        dist += Math.pow(Math.abs(ideologies[i].stats.prop - collectivism), 2)
        dist += Math.pow(Math.abs(ideologies[i].stats.cult - diversity), 2)
        if (dist < ideodist) {
            ideology = ideologies[i].name
            ideodist = dist
        }
    }
    document.getElementById("ideology-label").innerHTML = ideology

    function createImage(src, x, y, w, h) {
        img = new Image ()
        img.src = src
        img.onLoad = function() {
            ctx.drawImage(img, x, y, w, h)
        }
    }

    window.onload = function() {
        var c = document.getElementById("banner")
        var ctx = c.getContext("2d")
        ctx.fillStyle = "#EEEEEE"
        ctx.fillRect(0,0,800,600)

        img = document.getElementById("img-globalism")
        ctx.drawImage(img, 20, 120, 100, 100);
        img = document.getElementById("img-individualism")
        ctx.drawImage(img, 680, 120, 100, 100)
        img = document.getElementById("img-collectivism")
        ctx.drawImage(img, 20, 240, 100, 100)
        img = document.getElementById("img-privatism")
        ctx.drawImage(img, 680, 240, 100, 100)
        img = document.getElementById("img-diversity")
        ctx.drawImage(img, 20, 360, 100, 100)
        img = document.getElementById("img-cohesion")
        ctx.drawImage(img, 680, 360, 100, 100)

        ctx.fillStyle="#222222"
        ctx.fillRect(120, 130, 560, 80)
        ctx.fillRect(120, 250, 560, 80)
        ctx.fillRect(120, 370, 560, 80)
        ctx.fillStyle="#03a9f4"
        ctx.fillRect(120, 134, 5.6*globalism-2, 72)
        ctx.fillStyle="#ffeb3b"
        ctx.fillRect(682-5.6*individualism, 134, 5.6*individualism-2, 72)
        ctx.fillStyle="#ff0000"
        ctx.fillRect(120, 254, 5.6*collectivism-2, 72)
        ctx.fillStyle="#ff9800"
        ctx.fillRect(682-5.6*privatism, 254, 5.6*privatism-2, 72)
        ctx.fillStyle="#9c27b0"
        ctx.fillRect(120, 374, 5.6*diversity-2, 72)
        ctx.fillStyle="#8bc34a"
        ctx.fillRect(682-5.6*cohesion, 374, 5.6*cohesion-2, 72)
        ctx.fillStyle="#222222"
        ctx.font="700 80px Montserrat"
        ctx.textAlign="left"
        ctx.fillText("3d", 20, 90)
        ctx.font="40px Montserrat"
        ctx.textAlign="right"
        ctx.fillText(ideology, 780, 87.5)

        ctx.font="50px Montserrat"
        ctx.textAlign="left"
        if (globalism > 30) {ctx.fillText(globalism + "%", 130, 187.5)}
        if (collectivism  > 30) {ctx.fillText(collectivism+ "%", 130, 307.5)}      
        if (diversity > 30) {ctx.fillText(diversity + "%", 130, 427.5)}
        ctx.textAlign="right"
        if (individualism > 30) {ctx.fillText(individualism + "%", 670, 187.5)}
        if (privatism > 30) {ctx.fillText(privatism + "%", 670, 307.5)}
        if (cohesion      > 30) {ctx.fillText(cohesion + "%", 670, 427.5)}

        ctx.font="300 30px Montserrat"
        ctx.fillText("3dimensions.github.io", 780, 55)
        ctx.textAlign="center"
        ctx.fillText("Identity Axis: " + document.getElementById("identity-label").innerHTML, 400, 125)
        ctx.fillText("Property Axis: " + document.getElementById("property-label").innerHTML, 400, 245)
        ctx.fillText("Cultural Axis: " + document.getElementById("culture-label").innerHTML, 400, 365)
    }
    </script>
</body>
